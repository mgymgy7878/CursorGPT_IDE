# Cursor Rules - Actor Protocol v1.0
When: *
Instructions: |
  - All replies must start with cursor:.
  - Produce a single final summary (no mid-logs).
  - Use SUMMARY/VERIFY/APPLY/PATCH/FINALIZE formats with 11 bullets + HEALTH line.
  - Respect step-level secrets; skip dev-auth on fork PRs.
  - Do not promise future work; perform now or report blockers.

# chatgpt: Yanıt Formatı
When: Always
Instructions: |
  chatgpt: Tüm yanıtlarda başlangıç formatı: "cursor (AI model adı):" şeklinde olmalı.
  Örnek: "cursor (Claude 3.5 Sonnet):", "cursor (GPT-4):", vb.
  Bu format, hangi AI modelinin yanıt verdiğini açıkça gösterir.

# chatgpt: Proje Analiz Protokolü
When: User says "projeyi analiz et" or similar
Instructions: |
  chatgpt: Bu Spark Trading Platform projesidir. Proje yapısı:
  
  1. **Monorepo Mimarisi**: pnpm workspace ile yönetilen çoklu paket yapısı
     - apps/web-next: Next.js 14 frontend (port 3003)
     - services/executor: Node.js backend servis (port 4001)
     - packages/*: Paylaşılan kütüphaneler
  
  2. **Teknolojiler**:
     - Frontend: Next.js 14, TypeScript, Tailwind CSS, Zustand
     - Backend: Express, TypeScript, WebSocket
     - Araçlar: pnpm, ts-node-dev, ESBuild
  
  3. **Ana Özellikler**:
     - Trading stratejileri oluşturma ve yönetme
     - Gerçek zamanlı portföy takibi
     - Backtest motoru
     - Otomasyon kuralları
     - Prometheus metrikleri
  
  4. **Kritik Dosyalar**:
     - apps/web-next/app/page.tsx: Ana dashboard
     - services/executor/src/index.ts: Backend API
     - apps/web-next/next.config.js: Proxy ayarları
     - .env.local: Port ve URL konfigürasyonları
  
  5. **API Endpoints**:
     - /api/public/health: Sistem durumu
     - /api/public/metrics/prom: Prometheus metrikleri
     - /api/exec/start: Strateji başlatma
     - /api/exec/stop: Strateji durdurma
  
  6. **Geliştirme Komutları**:
     - Panel başlat: cd apps/web-next && pnpm dev
     - Executor başlat: cd services/executor && pnpm dev
     - Tüm bağımlılıkları yükle: pnpm -w install
  
  7. **Mevcut Sayfalar**:
     - /: Ana sayfa dashboard
     - /Gozlem: Sistem metrikleri
     - /PortfoyYonetimi: Pozisyonlar
     - /strategy-lab: Strateji oluşturma
     - /Stratejilerim: Strateji listesi
     - /Ayarlar: API ve sistem ayarları
     - /backtest-demo: Backtest aracı
     - /automation: Otomasyon kuralları
     - /control: Executor kontrol paneli
  
  8. **Bilinen Sorunlar**:
     - precision-registry.ts: Critical dependency uyarıları (göz ardı edilebilir)
     - styles/globals.css: Path sorunu (düzeltildi)
  
  9. **Güvenlik**:
     - JWT tabanlı authentication
     - Middleware ile korunan API rotaları
     - Public endpoint'ler için özel izinler
  
  10. **Performans**:
      - SSR devre dışı (dynamic imports)
      - Lazy loading componentler
      - WebSocket ile gerçek zamanlı veri
  
  11. **Sonraki Adımlar**:
      - Binance API entegrasyonu
      - WebSocket bağlantıları
      - Veritabanı entegrasyonu
      - Strateji execution engine
  
  HEALTH=GREEN (UI çalışıyor, backend hazır, tüm sayfalar aktif)

# chatgpt: İşlem Tamamlama Protokolü
When: User says "tüm işlemleri bitirdikten sonra" or similar
Instructions: |
  chatgpt: Tüm işlemleri tamamladıktan sonra şu formatta rapor ver:
  
  "cursor (AI model adı): Tüm işlemleri tamamladıktan sonra rapor ve önerilerimi sunuyorum..."
  
  Ardından:
  1. **SUMMARY** - Yapılan işlemlerin özeti (11 madde)
  2. **VERIFY** - Kontrol edilen noktalar
  3. **APPLY** - Uygulanan değişiklikler
  4. **PATCH** - Düzeltilen sorunlar
  5. **FINALIZE** - Sonuç ve öneriler
  6. **HEALTH=STATUS** - Genel durum
  
  Son olarak gelecek adımlar için öneriler sun.

# chatgpt: Rapor Formatı Hatırlatması
When: User says "bu formatı projeye hatırlatma olarak ekle" or similar
Instructions: |
  chatgpt: Tüm raporlarda şu formatı kullan:
  
  "cursor (AI model adı):" ile başla (örn: "cursor (Claude 3.5 Sonnet):")
  
  Ardından:
  - **SUMMARY** - Yapılan işlemlerin özeti (11 madde)
  - **VERIFY** - Kontrol edilen noktalar (varsa)
  - **APPLY** - Uygulanan değişiklikler (varsa)
  - **PATCH** - Düzeltilen sorunlar (varsa)
  - **FINALIZE** - Sonuç ve öneriler (varsa)
  - **HEALTH=STATUS** - Genel durum (GREEN/YELLOW/RED)
  
  Format örneği:
  "cursor (Claude 3.5 Sonnet): İŞLEM_ADI BAŞARILI ✅"
  
  Bu format tüm raporlarda tutarlı olmalı.

# chatgpt: Geri Sayım Sayacı Sistemi
When: Always
Instructions: |
  chatgpt: Tüm uzun süren işlemler için otomatik geri sayım sayacı kullan:
  
  PowerShell komutu:
  ```powershell
  Write-Host "⏰ X saniye geri sayım başlıyor..." -ForegroundColor Yellow; 
  for($i=X; $i -gt 0; $i--) { 
      Write-Host "⏳ $i saniye kaldı..." -ForegroundColor Cyan; 
      Start-Sleep -Seconds 1 
  }; 
  Write-Host "✅ Geri sayım tamamlandı!" -ForegroundColor Green
  ```
  
  Kullanım senaryoları:
  - Start-Sleep komutlarından önce
  - Process başlatma işlemlerinden önce
  - API test işlemlerinden önce
  - Build işlemlerinden önce
  
  Bu sistem Shift+Back ihtiyacını ortadan kaldırır ve kullanıcı deneyimini iyileştirir.

# chatgpt: Otomatik İşlem Takip Sistemi
When: Always
Instructions: |
  chatgpt: Tüm işlemler için otomatik takip ve devam mekanizması uygula:
  
  1. **Geri Sayım Sistemi**: Her uzun işlem öncesi otomatik geri sayım
  2. **Durum Tespiti**: İşlem sonrası otomatik durum kontrolü
  3. **Takip Mekanizması**: İşlem takılırsa otomatik devam
  4. **Hata Yönetimi**: Hata durumunda bir sonraki işleme geç
  
  PowerShell örnekleri:
  ```powershell
  # Geri sayım
  Write-Host "⏰ 10 saniye geri sayım başlıyor..." -ForegroundColor Yellow; 
  for($i=10; $i -gt 0; $i--) { 
      Write-Host "⏳ $i saniye kaldı..." -ForegroundColor Cyan; 
      Start-Sleep -Seconds 1 
  }; 
  Write-Host "✅ Geri sayım tamamlandı!" -ForegroundColor Green
  
  # Durum tespiti
  if (Test-Path .next) { 
      Write-Host "✅ .next dizini mevcut" -ForegroundColor Green 
  } else { 
      Write-Host "❌ .next dizini yok" -ForegroundColor Red 
  }
  
  # Otomatik test
  try { 
      $result = Invoke-RestMethod http://localhost:3003/ops -TimeoutSec 5; 
      Write-Host "✅ /ops: 200 OK" -ForegroundColor Green 
  } catch { 
      Write-Host "❌ /ops: $($_.Exception.Message)" -ForegroundColor Red 
  }
  ```
  
  Bu sistem sayesinde:
  - İşlemler takılmaz
  - Durum otomatik tespit edilir
  - Hata durumunda devam edilir
  - Kullanıcı müdahalesi gerekmez

# chatgpt: İşlem Devam Protokolü
When: User says "devam" or similar
Instructions: |
  chatgpt: "devam" komutu geldiğinde:
  
  1. **Durum Kontrolü**: Mevcut işlemlerin durumunu kontrol et
  2. **Takılan İşlem**: Varsa otomatik devam ettir
  3. **Sonraki Adım**: Bir sonraki mantıklı işleme geç
  4. **Geri Sayım**: Gerekirse otomatik geri sayım başlat
  5. **Rapor**: İşlem sonucunu raporla
  
  Örnek akış:
  - Build takıldıysa → PM2 restart
  - PM2 takıldıysa → Smoke test
  - Test takıldıysa → Log analizi
  - Log analizi takıldıysa → Sonraki işlem
  
  Bu sistem sayesinde hiçbir işlem yarıda kalmaz.

# chatgpt: Cursor Açılış Protokolü
When: Cursor starts or user opens project
Instructions: |
  chatgpt: Cursor her açıldığında otomatik olarak:
  
  1. **Proje Durumu**: PM2, build, endpoint durumlarını kontrol et
  2. **Geri Sayım**: Gerekli işlemler için otomatik geri sayım başlat
  3. **Durum Tespiti**: Tüm servislerin durumunu tespit et
  4. **Otomatik Devam**: Takılan işlemleri otomatik devam ettir
  5. **Rapor**: Mevcut durumu raporla
  
  Bu sayede kullanıcı her seferinde sıfırdan başlamaz, 
  kaldığı yerden devam eder.