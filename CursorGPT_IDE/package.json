{
  "name": "spark-monorepo",
  "version": "0.3.3",
  "description": "AI-Powered Trading Supervisor with Turkish Language Support",
  "private": true,
  "type": "module",
  "engines": {
    "node": ">=18.18.0 <21",
    "pnpm": ">=10.14.0"
  },
  "volta": {
    "node": "20.10.0"
  },
  "workspaces": [
    "apps/*",
    "packages/*",
    "services/executor",
    "tools/**"
  ],
  "packageManager": "pnpm@10.14.0",
  "pnpm": {
    "overrides": {
      "fastify": "4.29.1",
      "@fastify/rate-limit": "8.1.1",
      "@fastify/websocket": "8.3.1",
      "undici": "^7.14.0"
    }
  },
  "scripts": {
    "postinstall": "pnpm -w --aggregate-output -r run prepare || echo skip-prepare",
    "clean": "rimraf \"**/dist\"",
    "build": "tsc -b",
    "build:watch": "tsc -b -w",
    "start:marketdata": "node services/marketdata/dist/index.cjs",
    "start:executor": "node services/executor/dist/index.cjs",
    "dev:stack": "concurrently -n web,exec -c auto \"pnpm -C apps/web-next dev\" \"pnpm -C services/executor dev\"",
    "start:pm2": "pm2 start ecosystem.config.js --update-env && pm2 save",
    "stop:pm2": "pm2 delete all || true",
    "open:ui": "cmd /c scripts\\dev\\open-ui.cmd",
    "smoke:core-plus": "cmd /c scripts\\dev\\smoke-core-plus.cmd",
    "smoke:confirm": "node scripts/dev/smoke-confirm.mjs --out docs/evidence/dev/v2.2-ui --symbol BTCUSDT --qty 0.001 --dry true",
    "smoke:ai-quickstart": "node scripts/smoke/ui-ai-quickstart.mjs --out docs/evidence/dev/v2.2-ui --symbol BTCUSDT --qty 0.001 --leverage 5 --risk low",
    "dev:core-safe-win": "cmd /c scripts\\dev\\dev-core-safe-win.cmd",
    "smoke:core": "node scripts/dev/wait-for-http.mjs --out docs/evidence/dev/v2.2-ui --url http://127.0.0.1:4001/api/futures/time --url http://127.0.0.1:4001/api/futures/exchangeInfo?symbol=BTCUSDT --url http://127.0.0.1:3003/api/public/metrics",
    "i:fast": "pnpm -w i --ignore-scripts",
    "build:core-fast": "pnpm -w -F @spark/types exec tsc -p packages/@spark/types/tsconfig.build.json && pnpm -w -F @spark/shared exec tsc -p packages/@spark/shared/tsconfig.json",
    "dev:web": "pnpm -F web-next dev",
    "dev:exec": "pnpm -F executor dev",
    "dev:core-win": "cmd /c scripts\\dev\\dev-core-win.cmd",
    "dev:core-fast-win": "cmd /c scripts\\dev\\dev-core-fast-win.cmd",
    "dev:runner": "node tools/dev-runner.mjs",
    "smoke:futures": "powershell -NoProfile -ExecutionPolicy Bypass -File ./scripts/smoke-futures.ps1",
    "ui:smoke": "powershell -NoProfile -ExecutionPolicy Bypass -File ./scripts/ui-smoke.ps1",
    "build:clean": "pnpm run clean && pnpm run build",
    "build:types": "tsc -b tsconfig.packages.json",
    "clean:types": "tsc -b tsconfig.packages.json --clean",
    "tsc:clean:core": "node -e \"const fs=require('fs');const p=require('path');(function rm(d){if(fs.existsSync(d))for(const f of fs.readdirSync(d,{withFileTypes:true})){const fp=p.join(d,f.name);if(f.isDirectory())rm(fp);else if(f.name.endsWith('.tsbuildinfo'))fs.rmSync(fp)}})('.')\"",
    "tsc:clean:all": "tsc -b --clean tsconfig.references.json",
    "build:core": "tsc -b tsconfig.references.core.json",
    "rebuild:core": "pnpm run tsc:clean:core && pnpm run build:types && tsc -b tsconfig.references.core.json",
    "rebuild:all": "pnpm run tsc:clean:all && pnpm run build:types && tsc -b tsconfig.references.json",
    "ts:diag:core": "powershell -ExecutionPolicy Bypass -File scripts/ts-diagnose.ps1",
    "dev:verify:win": "cmd /c scripts\\dev-verify.cmd",
    "dev:one": "wscript.exe //nologo scripts\\one-shot.vbs",
    "typecheck:workspaces": "pnpm -r --workspace-concurrency=1 exec tsc -p tsconfig.json --noEmit",
    "typecheck:web": "pnpm -F web-next exec tsc -p tsconfig.json --noEmit",
    "typecheck:executor": "pnpm -F executor exec tsc -p tsconfig.json --noEmit",
    "typecheck": "tsc -p tsconfig.references.json --noEmit",
    "typecheck:all": "pnpm -r --workspace-concurrency=1 run typecheck || true",
    "typecheck:clean": "tsc -b --clean",
    "typecheck:core": "pnpm run build:types && tsc -b tsconfig.references.core.json --pretty false",
    "lint": "pnpm -r exec eslint .",
    "lint:fix": "pnpm -r exec eslint . --fix",
    "dev:api": "pnpm -w -F @spark/executor dev",
    "dev:up": "powershell -NoProfile -ExecutionPolicy Bypass -File tools/dev-up.ps1",
    "dev:down": "powershell -NoProfile -ExecutionPolicy Bypass -File tools/dev-down.ps1",
    "smoke:all": "powershell -NoProfile -ExecutionPolicy Bypass -File tools/smoke-all.ps1 -WebBase http://127.0.0.1:4001 -Token dev-xyz -N 20",
    "smoke:p95": "powershell -NoProfile -ExecutionPolicy Bypass -File tools/p95.ps1 -N 20 -Token dev-xyz -WebBase http://127.0.0.1:4001",
    "smoke:metrics": "powershell -NoProfile -ExecutionPolicy Bypass -File tools/metrics-read.ps1 -WebBase http://127.0.0.1:4001 -ExecBase http://127.0.0.1:4001",
    "dev:verify": "node tools/smoke.cjs --all --retries 40 --sleep 2000",
    "deps:dedupe": "pnpm -w dedupe",
    "deps:why": "pnpm -w why",
    "logs:web": "powershell -NoProfile -Command \"Get-Content -Wait -Tail 50 logs\\web-next.txt\"",
    "logs:api": "powershell -NoProfile -Command \"Get-Content -Wait -Tail 50 logs\\executor.txt\"",
    "guard:deep-imports": "node scripts/guard/deep-import-guard.mjs",
    "smoke:subpath": "pnpm -w run build:types && node tools/smoke-subpath.mjs",
    "smoke:runtime": "pnpm -w run build:types && node tools/smoke-runtime.mjs",
    "smoke:ui": "node tools/smoke.cjs ui",
    "smoke:api": "node tools/smoke.cjs api",
    "smoke": "node tools/smoke.cjs --all",
    "barrels": "node tools/make-barrels.mjs",
    "dep:audit": "pnpm dlx depcheck --json > evidence/audit/depcheck.json 2>&1 || exit 0",
    "dep:unused": "pnpm dlx ts-prune --ignore \"node_modules|dist|.next|evidence\" > evidence/audit/ts_prune.txt 2>&1 || exit 0",
    "dep:circular": "pnpm dlx madge --circular --extensions ts,tsx,js apps services packages > evidence/audit/madge_circular.txt 2>&1 || exit 0",
    "check:fast": "pnpm -w typecheck:core && pnpm -w lint",
    "check:deep": "pnpm -w check:fast && pnpm -w dep:audit && pnpm -w dep:unused && pnpm -w dep:circular",
    "doctor": "node tools/doctor.cjs",
    "fix:imports": "node tools/fix-import-specifiers.mjs",
    "install:all": "pnpm -w install",
    "clean:web": "powershell -NoProfile -Command \"if (Test-Path apps/web-next/.next) { Remove-Item -Recurse -Force apps/web-next/.next }\"",
    "clean:api": "powershell -NoProfile -Command \"if (Test-Path services/executor/dist) { Remove-Item -Recurse -Force services/executor/dist }\"",
    "clean": "pnpm run clean:web && pnpm run clean:api",
    "backup": "powershell -NoProfile -ExecutionPolicy Bypass -File tools/backup-config.ps1",
    "guard:cursor": "node -e \"process.exit(0)\"",
    "guard:ts-types": "node -e \"const fs=require('fs'),p=require('path');let bad=[];(function w(d){for(const f of fs.readdirSync(d)){const x=p.join(d,f),s=fs.statSync(x);if(s.isDirectory()){if(f==='node_modules')continue;w(x);}else if(/^tsconfig.*\\.json$/i.test(f)){try{const j=JSON.parse(fs.readFileSync(x,'utf8'));if(j.compilerOptions&&Array.isArray(j.compilerOptions.types)&&j.compilerOptions.types.includes('@spark'))bad.push(x);}catch(e){console.warn('JSON parse error in',x);}}}})('.'); if(bad.length){console.error('Forbidden @spark types in:',bad);process.exit(1);} else {console.log('OK: no @spark types');}\"",
    "guard:postcss": "node -e \"const fs=require('fs'),p=require('path');const names=['postcss.config.js','postcss.config.cjs','postcss.config.mjs','tailwind.config.js','tailwind.config.cjs','tailwind.config.mjs'];const found=[];for(const name of names){const path=p.join('apps/web-next',name);if(fs.existsSync(path))found.push(path);}if(found.length===2){console.log('OK: PostCSS/Tailwind config bulundu →',found);}else{console.error('PostCSS/Tailwind config eksik veya fazla:',found);process.exit(1);}\"",
    "guard:aliases": "node -e \"const fs=require('fs'); const tsconfig = JSON.parse(fs.readFileSync('apps/web-next/tsconfig.json', 'utf8')); if(!tsconfig.compilerOptions?.paths?.['@/*']) { console.error('@ alias not found in web-next tsconfig'); process.exit(1); } console.log('OK: @ alias configured');\"",
    "ci:exchange": "echo 'Exchange tests skipped - jest not available'",
    "ci:verify": "pnpm guard:postcss && pnpm guard:ts-types && pnpm guard:aliases && pnpm smoke && pnpm ci:exchange",
    "predev": "pnpm run build:types",
    "prebuild": "pnpm guard:ts-types && pnpm guard:postcss && pnpm guard:aliases",
    "prepare": "echo 'Skipping husky setup'",
    "smoke:ui-v2.2": "bash scripts/smoke/ui-v2.2-smoke.sh || cmd /c scripts\\smoke\\ui-v2.2-smoke.cmd",
    "evidence:ui-v2.2": "pnpm smoke:ui-v2.2 && echo 'Evidence → docs/evidence/dev/v2.2-ui'",
    "evidence:snapshot": "node scripts/metrics/prom-snapshot.mjs --out docs/evidence/dev/v2.2-ui",
    "ci:pin-actions": "node scripts/ci/pin-actions.mjs",
    "rescue:ui": "cmd /c scripts\\ui\\UI-RESCUE-AND-COLLECT.cmd",
    "ci:pin-actions:all": "node scripts/ci/pin-all.mjs",
    "runner:smoke": "powershell -ExecutionPolicy Bypass -File scripts/runner-smoke.ps1",
    "runner:step": "powershell -ExecutionPolicy Bypass -File scripts/Invoke-Step.ps1",
    "report:daily": "powershell -ExecutionPolicy Bypass -File scripts/daily-report.ps1",
    "canary:retry": "powershell -ExecutionPolicy Bypass -File scripts/canary-with-retry.ps1",
    "runner:configurable": "node tools/runStepConfigurable.cjs",
    "ci:runner-smoke": "pnpm run runner:smoke && pnpm run report:daily",
    "evidence:rotate": "powershell -ExecutionPolicy Bypass -File scripts/evidence-rotation.ps1",
    "config:validate": "powershell -ExecutionPolicy Bypass -File scripts/config-schema-validate.ps1",
    "chaos:test": "powershell -ExecutionPolicy Bypass -File scripts/chaos-test.ps1",
    "chaos:burst": "powershell -ExecutionPolicy Bypass -File scripts/chaos-test.ps1 burst",
    "incident:analyze": "powershell -ExecutionPolicy Bypass -File scripts/incident-analyze.ps1",
    "incident:scope": "powershell -ExecutionPolicy Bypass -File scripts/incident-scope.ps1",
    "self:check": "powershell -ExecutionPolicy Bypass -File scripts/self-check-heartbeat.ps1",
    "thresholds:adaptive": "powershell -ExecutionPolicy Bypass -File scripts/adaptive-thresholds.ps1",
    "incident:summarize": "powershell -ExecutionPolicy Bypass -File scripts/incident-summarizer.ps1",
    "snapshot:diffs": "powershell -ExecutionPolicy Bypass -File scripts/snapshot-diffs.ps1",
    "correlation:analyze": "powershell -ExecutionPolicy Bypass -File scripts/correlation-graph.ps1",
    "neural:feedback": "powershell -ExecutionPolicy Bypass -File scripts/neural-feedback-loop.ps1",
    "memory:analyze": "powershell -ExecutionPolicy Bypass -File scripts/cognitive-memory.ps1",
    "predictive:alert": "powershell -ExecutionPolicy Bypass -File scripts/predictive-alerting.ps1",
    "automation:suggest": "powershell -ExecutionPolicy Bypass -File scripts/automation-suggestions.ps1",
    "incident:auto-close": "powershell -ExecutionPolicy Bypass -File scripts/incident-auto-close.ps1",
    "green:validate": "powershell -ExecutionPolicy Bypass -File scripts/green-validation.ps1",
    "maintenance:run": "powershell -ExecutionPolicy Bypass -File scripts/maintenance-automation.ps1",
    "prod:guards": "powershell -ExecutionPolicy Bypass -File scripts/prod-guards.ps1",
    "ops:harden": "powershell -ExecutionPolicy Bypass -File scripts/operational-hardening.ps1",
    "fusion:integrate": "powershell -ExecutionPolicy Bypass -File scripts/fusion-integration.ps1",
    "prometheus:fix": "powershell -ExecutionPolicy Bypass -File scripts/prometheus-fix.ps1",
    "executor:harden": "powershell -ExecutionPolicy Bypass -File scripts/executor-metrics-harden.ps1",
    "threshold:enforce": "powershell -ExecutionPolicy Bypass -File scripts/threshold-freeze-enforce.ps1",
    "recovery:one-shot": "powershell -ExecutionPolicy Bypass -File scripts/one-shot-recovery.ps1",
    "prometheus:up": "powershell -ExecutionPolicy Bypass -File scripts/prometheus-up.ps1",
    "executor:up": "powershell -ExecutionPolicy Bypass -File scripts/executor-up.ps1",
    "md:fetch": "pnpm -F @spark/marketdata fetch:binance",
    "md:csv": "pnpm -F @spark/marketdata dump:csv ./packages/marketdata/data/BTCUSDT_1m.json",
    "bt:run": "cd packages/backtest && node dist/cli.js --strategy sma_cross --file ../marketdata/data/BTCUSDT_1m.csv"
  },
  "keywords": [
    "trading",
    "ai",
    "supervisor",
    "turkish",
    "binance",
    "strategy"
  ],
  "author": "AI Trading Team",
  "license": "MIT",
  "dependencies": {
    "@fastify/cors": "^11.1.0",
    "@fastify/type-provider-typebox": "^5.2.0",
    "@monaco-editor/react": "^4.7.0",
    "@prisma/client": "^5.22.0",
    "@sinclair/typebox": "^0.34.41",
    "axios": "^1.12.2",
    "csv-writer": "^1.6.0",
    "fast-json-stringify": "^6.0.1",
    "fastify": "^4.29.1",
    "fastify-plugin": "^4.5.1",
    "mitt": "^3.0.1",
    "next": "14.2.32",
    "node-cron": "^3.0.3",
    "node-fetch": "^3.3.2",
    "openpgp": "^5.4.0",
    "recharts": "^2.15.4",
    "ssh2": "^1.15.0",
    "ws": "^8.18.3",
    "zod": "^3.25.76"
  },
  "devDependencies": {
    "@types/node": "^18.19.124",
    "@types/ws": "^8.18.1",
    "@typescript-eslint/eslint-plugin": "6.21.0",
    "@typescript-eslint/parser": "6.21.0",
    "concurrently": "8.2.2",
    "cross-env": "7.0.3",
    "eslint": "8.57.0",
    "eslint-config-next": "14.2.5",
    "fast-glob": "^3.3.3",
    "husky": "^9.1.7",
    "lint-staged": "^16.1.6",
    "pm2": "^5.3.0",
    "prisma": "^5.22.0",
    "rimraf": "^5.0.7",
    "tsup": "^8.5.0",
    "tsx": "^4.16.0",
    "typescript": "^5.9.2"
  },
  "lint-staged": {
    "*.{ts,tsx,js,cjs,mjs,json}": [
      "pnpm -w eslint --fix",
      "pnpm -w tsc -p tsconfig.json --noEmit --pretty false"
    ]
  }
}
